<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ingredient & Recipe Manager</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
    * { margin:0; padding:0; box-sizing: border-box; font-family: 'Roboto', sans-serif; }
    
    body {
        min-height: 100vh;
        background: linear-gradient(135deg, #3c6e47, #a0e9d8, #d3f4ff);
        padding: 20px;
        transition: background 1s ease;
    }

    h1 { text-align: center; color: #ffffff; text-shadow: 1px 1px 4px #2a4b30; margin-bottom: 20px; }
    h2 { color: #3c6e47; margin-top: 30px; }
    hr { border: none; border-top: 2px solid #d3d3d3; margin: 30px 0; }

    /* Forms */
    form { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-bottom: 20px; }
    input[type=text], textarea { padding: 10px; border-radius: 6px; border: 1px solid #ccc; flex: 1; }
    button { 
        background: #3c6e47; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;
        font-weight: 500; transition: 0.3s;
    }
    button:hover { background: #2e5235; transform: scale(1.05); }

    /* Cards */
    .card { 
        background: rgba(255,255,255,0.95); 
        padding: 25px; border-radius: 16px; margin-bottom: 30px; 
        box-shadow: 0 8px 25px rgba(0,0,0,0.2); 
        transition: transform 0.3s, box-shadow 0.3s;
    }
    .card:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(0,0,0,0.25); }

    /* Tables */
    table { width: 100%; border-collapse: collapse; margin-top: 10px; border-radius: 12px; overflow: hidden; }
    th, td { padding: 12px 15px; text-align: left; }
    th { background: #e0f2e9; color: #3c6e47; font-weight: 600; }
    tr:nth-child(even) { background: #f7f9f8; }
    tr:hover { background: #d9f0de; transition: 0.2s; }

    /* Buttons in table */
    .btn-small { padding: 6px 10px; border-radius: 4px; border: none; cursor: pointer; font-size: 0.9em; margin-left: 5px; }
    .edit { background: #ffa500; color: white; }
    .edit:hover { background: #e59400; transform: scale(1.1); }
    .delete { background: #e74c3c; color: white; }
    .delete:hover { background: #c0392b; transform: scale(1.1); }
</style>
</head>
<body>

<h1>üçÉ Ingredient & Recipe Manager</h1>

<div class="card">
    <h2>Add Ingredient</h2>
    <form id="ingredientForm">
        <input type="text" id="ingredientName" placeholder="Ingredient Name" required>
        <input type="text" id="ingredientQty" placeholder="Quantity" required>
        <button type="submit">Add Ingredient</button>
    </form>
    <h3>All Ingredients</h3>
    <table id="ingredientTable">
        <tr><th>ID</th><th>Name</th><th>Quantity</th><th>Actions</th></tr>
    </table>
</div>

<div class="card">
    <h2>Add Recipe</h2>
    <form id="recipeForm">
        <input type="text" id="recipeName" placeholder="Recipe Name" required>
        <textarea id="recipeInstructions" placeholder="Instructions" rows="3"></textarea>
        <button type="submit">Add Recipe</button>
    </form>
    <h3>All Recipes</h3>
    <table id="recipeTable">
        <tr><th>ID</th><th>Name</th><th>Instructions</th><th>Actions</th></tr>
    </table>
</div>

<script>
const ING_URL = "http://127.0.0.1:5000/ingredients";
const REC_URL = "http://127.0.0.1:5001/recipes";

/* ---------- Ingredient Functions ---------- */
async function loadIngredients() {
    const res = await fetch(ING_URL);
    const data = await res.json();
    const table = document.getElementById("ingredientTable");
    table.innerHTML = "<tr><th>ID</th><th>Name</th><th>Quantity</th><th>Actions</th></tr>";
    data.forEach(i => {
        table.innerHTML += `<tr>
            <td>${i.id}</td>
            <td>${i.name}</td>
            <td>${i.quantity}</td>
            <td>
                <button class="btn-small edit" onclick="editIngredient('${i.id}', '${i.name}', '${i.quantity}')">Edit</button>
                <button class="btn-small delete" onclick="deleteIngredient('${i.id}')">Delete</button>
            </td>
        </tr>`;
    });
}

async function addIngredient(name, quantity) {
    await fetch(ING_URL, { method: "POST", headers: {"Content-Type": "application/json"}, body: JSON.stringify({ name, quantity }) });
    loadIngredients();
}
async function updateIngredient(id, name, quantity) { await fetch(`${ING_URL}/${id}`, { method:"PUT", headers:{"Content-Type":"application/json"}, body: JSON.stringify({name,quantity}) }); loadIngredients(); }
async function deleteIngredient(id) { if(confirm("Are you sure you want to delete this ingredient?")) { await fetch(`${ING_URL}/${id}`,{method:"DELETE"}); loadIngredients(); } }
function editIngredient(id,name,qty) { const newName = prompt("Edit Name:",name); if(newName===null) return; const newQty = prompt("Edit Quantity:",qty); if(newQty===null) return; updateIngredient(id,newName,newQty); }

/* ---------- Recipe Functions ---------- */
async function loadRecipes() {
    const res = await fetch(REC_URL);
    const data = await res.json();
    const table = document.getElementById("recipeTable");
    table.innerHTML = "<tr><th>ID</th><th>Name</th><th>Instructions</th><th>Actions</th></tr>";
    data.forEach(r => {
        table.innerHTML += `<tr>
            <td>${r.id}</td>
            <td>${r.name}</td>
            <td>${r.instructions}</td>
            <td>
                <button class="btn-small edit" onclick="editRecipe('${r.id}','${r.name}','${r.instructions}')">Edit</button>
                <button class="btn-small delete" onclick="deleteRecipe('${r.id}')">Delete</button>
            </td>
        </tr>`;
    });
}

async function addRecipe(name, instructions) {
    await fetch(REC_URL, { method: "POST", headers: {"Content-Type": "application/json"}, body: JSON.stringify({ name, instructions }) });
    loadRecipes();
}
async function updateRecipe(id,name,instructions){await fetch(`${REC_URL}/${id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name,instructions})});loadRecipes();}
async function deleteRecipe(id){if(confirm("Are you sure you want to delete this recipe?")){await fetch(`${REC_URL}/${id}`,{method:"DELETE"});loadRecipes();}}
function editRecipe(id,name,instructions){const newName=prompt("Edit Name:",name);if(newName===null)return;const newInstr=prompt("Edit Instructions:",instructions);if(newInstr===null)return;updateRecipe(id,newName,newInstr);}

/* ---------- Form Listeners ---------- */
document.getElementById("ingredientForm").addEventListener("submit",e=>{e.preventDefault();addIngredient(document.getElementById("ingredientName").value,document.getElementById("ingredientQty").value);e.target.reset();});
document.getElementById("recipeForm").addEventListener("submit",e=>{e.preventDefault();addRecipe(document.getElementById("recipeName").value,document.getElementById("recipeInstructions").value);e.target.reset();});

/* ---------- Initial Load ---------- */
loadIngredients();
loadRecipes();
</script>

</body>
</html>
